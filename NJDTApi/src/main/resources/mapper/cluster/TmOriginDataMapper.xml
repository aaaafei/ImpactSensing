<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jsti.tunnel.monitor.dao.cluster.TmOriginDataDao">
  <resultMap id="BaseResultMap" type="com.jsti.tunnel.monitor.bean.TmOriginData">
    <id column="ic" jdbcType="BIGINT" property="ic" />
    <result column="clientip" jdbcType="VARCHAR" property="clientip" />
    <result column="clientport" jdbcType="VARCHAR" property="clientport" />
    <result column="clientimei" jdbcType="VARCHAR" property="clientimei" />
    <result column="catalog" jdbcType="VARCHAR" property="catalog" />
    <result column="catalogval" jdbcType="VARCHAR" property="catalogval" />
    <result column="voltage" jdbcType="VARCHAR" property="voltage" />
    <result column="signalval" jdbcType="VARCHAR" property="signalval" />
    <result column="contents" jdbcType="VARCHAR" property="contents" />
    <result column="timstamp" jdbcType="TIMESTAMP" property="timstamp" />
    <result column="type" jdbcType="VARCHAR" property="mtype" />
    <result column="line" jdbcType="VARCHAR" property="line" />
    <result column="segment" jdbcType="VARCHAR" property="segment" />
    <result column="stake_number" jdbcType="VARCHAR" property="stakeNumber" />
  </resultMap>

  <sql id="Base_Column_List">
    ic, clientip, clientport, clientimei, catalog, catalogval, voltage, signalval, contents, timstamp
  </sql>

  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from rawdata
    where id = #{ic,jdbcType=BIGINT}
  </select>

  <select id="selectList" parameterType="com.jsti.tunnel.monitor.pojo.TmOriginDataParams" resultMap="BaseResultMap">
    select
      r.ic, r.clientip, r.clientport, r.clientimei, r.catalog, r.catalogval, r.voltage, r.signalval, r.contents, r.timstamp,
      d.`type`, d.line, d.segment, d.stake_number
    from rawdata r
    left join impact_sensing_njdt.tm_device d ON r.clientimei = d.code
    <where>
      <if test="clientip!=null">and r.clientip=#{clientip}</if>
      <if test="clientport!=null">and r.clientport=#{clientport}</if>
      <if test="clientimei!=null">and r.clientimei=#{clientimei}</if>
      <if test="catalog!=null">and r.catalog=#{catalog}</if>
      <if test="catalogval!=null">and r.catalogval=#{catalogval}</if>
      <if test="signalval!=null">and r.signalval=#{signalval}</if>
      <if test="beginDate!=null">and r.timstamp>=#{beginDate}</if>
      <if test="endDate!=null">and #{endDate}>=r.timstamp </if>
    </where>
  </select>


  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    delete from rawdata
    where ic = #{ic,jdbcType=BIGINT}
  </delete>

</mapper>