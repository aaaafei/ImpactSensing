<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jsti.tunnel.monitor.dao.master.TmSubsideDao">

    <resultMap id="SubsideResultMap" type="com.jsti.tunnel.monitor.bean.TmSubside">
        <id column="leaf_id" jdbcType="BIGINT" property="id" />
        <result column="device1_code" jdbcType="VARCHAR" property="device1_code" />
        <result column="device1_stake_number" jdbcType="VARCHAR" property="device1_stake_number" />
        <result column="device1_realtime_physical_data" jdbcType="VARCHAR" property="device1_realtime_physical_data" />
        <result column="device1_initial_value" jdbcType="VARCHAR" property="device1_initial_value" />
        <result column="device2_code" jdbcType="VARCHAR" property="device2_code" />
        <result column="device2_stake_number" jdbcType="VARCHAR" property="device2_stake_number" />
        <result column="device1_realtime_physical_data" jdbcType="VARCHAR" property="device1_realtime_physical_data" />
        <result column="device1_initial_value" jdbcType="VARCHAR" property="device1_initial_value" />
        <result column="collect_time" jdbcType="VARCHAR" property="collect_time" />
    </resultMap>

    <select id="selectSubside" parameterType="java.util.Map" resultMap="SubsideResultMap">
        SELECT c.*
          ,d.`code` AS device1_code, d.stake_number AS device1_stake_number, d.realtime_physical_data AS device1_realtime_physical_data, d.initial_value AS device1_initial_value
          ,d2.`code` AS device2_code,d2.stake_number AS device2_stake_number, d2.realtime_physical_data AS device2_realtime_physical_data, d2.initial_value AS device2_initial_value
          ,d.line,d.segment,d.type AS monitor_item,d.collect_time
        FROM `tm_calculate_value_config` c
        LEFT JOIN tm_device d ON d.id = c.device1_id
        LEFT JOIN tm_device d2 ON d2.id = c.device2_id
        WHERE c.type = 2
        <if test="segment!=null">and d.segment = #{segment}</if>
        <if test="line!=null">and d.line = #{line}</if>
        <if test="type!=null">and d.type = #{type}</if>
    </select>
  

</mapper>