<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jsti.tunnel.monitor.dao.master.MenuDao" >
    <resultMap id="BaseResultMap" type="com.jsti.tunnel.monitor.bean.Menu" >
        <id column="id" property="id" jdbcType="INTEGER" />
        <result column="menuname" property="menuname" jdbcType="VARCHAR" />
        <result column="url" property="url" jdbcType="VARCHAR" />
        <result column="iconClass" property="iconClass" jdbcType="VARCHAR" />
        <result column="parentId" property="parentId" jdbcType="INTEGER" />
        <result column="type" property="type" jdbcType="INTEGER" />     
        <result column="sortNo" property="sortNo" jdbcType="INTEGER" />  
        <result column="status" property="status" jdbcType="INTEGER" />
        <result column="remark" property="remark" jdbcType="VARCHAR" />
    </resultMap>

   <select id="getMenu" parameterType="com.jsti.tunnel.monitor.bean.Menu" resultMap="BaseResultMap">
        SELECT 
        id,menuname,url,iconClass,parentId,type,sortNo,status,remark
         FROM sys_menu
         where status!=-1
         <if test="id != null and id != 1">and id = #{id}</if>
         <if test="menuname != null">and menuname = #{menuname}</if>
         <if test="iconClass != null">and iconClass = #{iconClass}</if>
         <if test="url != null">and url = #{url}</if>
         <if test="parentId != null and parentId != 1">and parentId = #{parentId}</if>
         <if test="type != null and type != 0">and type = #{type}</if>
         <if test="sortNo != null and sortNo != 0">and sortNo = #{sortNo}</if>
         <if test="status != null">and status = #{status}</if>
         order by sortNo,id
    </select>
    
	<select id="getMenuByParent" parameterType="com.jsti.tunnel.monitor.bean.Menu" resultMap="BaseResultMap">
        SELECT 
        id,menuname,url,iconClass,parentId,type,sortNo,status,remark
         FROM sys_menu
         where status!=-1
         <if test="parentId != null and parentId != 1">and (parentId = #{parentId} or id = #{parentId})</if>
         <if test="menuname != null">and menuname LIKE CONCAT('%',#{menuname},'%')</if>
    	order by sortNo,id
    </select>
    
    <insert id="insert" parameterType="com.jsti.tunnel.monitor.bean.Menu" >
        INSERT INTO
        sys_menu
        (menuname,url,iconClass,parentId,type,sortNo,status,remark)
        VALUES
        (#{menuname},#{url},#{iconClass},#{parentId},#{type},#{sortNo},#{status},#{remark})
    </insert>

    <update id="update" parameterType="com.jsti.tunnel.monitor.bean.Menu" >
        UPDATE
        sys_menu
        SET
         id = #{id}
         <if test="menuname != null">, menuname = #{menuname}</if>
         <if test="iconClass != null">, iconClass = #{iconClass}</if>
         <if test="url != null">, url = #{url}</if>
         <if test="parentId != null and parentId != 1">, parentId = #{parentId}</if>
         <if test="type != null and type != 0">, type = #{type}</if>
         <if test="sortNo != null and sortNo != 0">, sortNo = #{sortNo}</if>
         <if test="status != null and status != 0">, status = #{status}</if>
         <if test="remark != null">,remark = #{remark}</if>
        WHERE
        id = #{id}
    </update>

    <delete id="delete" parameterType="java.lang.Integer" >
        update sys_menu
         set status=-1
        WHERE
        id =#{id}
    </delete>
</mapper>